<!--
<loot-dropdown-menu> is an extension of <paper-dropdown-menu> that gives
it a <select>-like API. This means:

1. `<paper-item>.value` attributes are used to reference items.
2. `<loot-dropdown-menu>.value` references the currently selected item.

-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../bower_components/core-menu/core-menu.html">

<polymer-element name="loot-dropdown-menu" attributes="disabled">
    <template>
        <paper-dropdown-menu disabled?="{{disabled}}">
            <paper-dropdown class="dropdown">
                <core-menu valueattr="value">
                    <content></content>
                </core-menu>
            </paper-dropdown>
        </paper-dropdown-menu>
    </template>
    <script>
    Polymer({
        value: undefined,
        disabled: false,

        attached: function() {
            this.shadowRoot.firstElementChild.lastElementChild.firstElementChild.addEventListener('core-select', this.onItemSelect, false);
        },

        detached: function() {
            this.shadowRoot.firstElementChild.lastElementChild.firstElementChild.removeEventListener('core-select', this.onItemSelect, false);
        },

        onItemSelect: function(evt) {
            if (evt.detail.isSelected) {
                evt.currentTarget.parentElement.parentElement.parentNode.host.value = evt.currentTarget.selected;
            }
        },

        valueChanged: function(oldValue, newValue) {
            this.shadowRoot.firstElementChild.lastElementChild.firstElementChild.selected = newValue;
        },
    });
    </script>
</polymer-element>
